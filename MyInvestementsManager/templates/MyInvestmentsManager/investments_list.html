{% load custom_filters %}
{% load humanize %}
{% block content %}
<p> Investments Summary </p>

<table class="table table-striped table-bordered" id = "investmentsList">
	<tr>
		<td>Name</td>
		<td>Currency</td>
		<td>Investment Type</td>
		<td>Invested Amount</td>
		<td>Symbol</td>
		<td>Quantity</td>
		<td>Current Value</td>
		<td>Growth</td>
		<td>Growth Percentage</td>
		<td>Invested Date</td>
		<td/>
		<td/>
	</tr>
	{% for data in object_list %}
	<tr>
		<td><a href="viewInvestment/{{ data.id }}/" >{{ data.name }}</a></td>
		<td>{{ data.currency }}</td>
		<td>{{ data.investmentType.name }}</td>		
		<td>{{ data.amount| floatformat:2 | intcomma }}</td>
		<td>{{ data.symbol.symbol }}</td>
		<td>{{ data.quantity| floatformat:2 | intcomma}}</td>
		<td>{{ data.currentValue| floatformat:2 | intcomma}}</td>
		<td>{{ data.growth| floatformat:2 | intcomma}}</td>
		<td>{{ data.growthPercentage | floatformat:2 | intcomma}}%</td>
		<td>{{ data.date }}</td>
		<td><a href="deleteInvestment/{{ data.id }}/" ><span class="glyphicon glyphicon-remove" aria-hidden = "true"/></a></td>
		<td><a href="updateInvestment/{{ data.id }}/" ><span class="glyphicon glyphicon-pencil" aria-hidden = "true"/></a></td>
	
	</tr>
	{% endfor%}
	
	<tr>
		<th>Total</th>
		<th>{{ currency }}</th>
		<th></th>		
		<th>{{ totalAmount| floatformat:2 | intcomma}}</th>
		<th></th>
		<th></th>
		<th>{{ totalCurrentValue | floatformat:2 | intcomma}}</th>
		<th>{{ totalGrowth| floatformat:2 | intcomma}}</th>
		<th>{{ totalGrowthPercentage| floatformat:2 | intcomma}}%</th>
		<th></th>
		<th></th>
		<th></th>
	
	</tr>
	
</table>

<div class="container-fluid">
    <div class="row">
        <div class="col-lg-6" id="investmentsView">
            Container Left
        </div>
        <div class="col-lg-6" id="investmentRatios">
            Container Right
        </div>
    </div>
</div>
<script>	

//JSON text for investments
var jsonTextInvestments ='[' +
{% for data in object_list %}
	'{"name" : "{{ data.name }}", "y" :  {{ data.currentValue|div:totalCurrentValue }} },'+
{% endfor%}
	']';

	//remove the comma of last item
	jsonTextInvestments = jsonTextInvestments.slice(0, -2) + ']';

	var jsonObjectInvestments = jQuery.parseJSON(jsonTextInvestments);

	//draw the chart for investments
	drawPieChart('investmentsView', 'Investments By Current Value', 'Investment', jsonObjectInvestments);

	
	
//JSON text for BOND / STOCKS ratio
var jsonTextBondStocksRatio ='[' +
	
		'{"name" : "Bonds", "y" :  {{ totalBondValue|div:totalCurrentValue }} },'+
		'{"name" : "Equity", "y" :  {{ totalEquityValue|div:totalCurrentValue }} }'+
	
		']';
		
var jsonObjectInvestmentRatios = jQuery.parseJSON(jsonTextBondStocksRatio);

	
//draw the chart for Bond / Stock ratio
drawPieChart('investmentRatios', 'Bond / Stocks Ratio', 'Investment', jsonObjectInvestmentRatios);



</script>
{% endblock %}